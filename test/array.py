# import the library pulp as p
import pulp as p

# Create a LP Minimization problem
Lp_prob = p.LpProblem('Problem', p.LpMinimize)
# Create problem Variables
x = p.LpVariable.dicts("x", range(5), lowBound=0, upBound=None, cat=p.LpContinuous)

z = p.LpVariable.dicts("z", range(9), lowBound=0, upBound=None, cat=p.LpBinary)
# Objective Function
Lp_prob += p.lpSum([z[0], z[1], z[2], z[3], z[4], z[5], z[6], z[7], z[8]])

bigM = 10000
# 6 correct equations passing through [0.14083063, 0.09866791, 0.76855305, 0.50654552, 0.48474175]
Lp_prob += p.lpSum([0.4358122152170364*x[0], 0.7852764020735313*x[1], 0.7913074666352077*x[2], 0.8473006173083598*x[3], 0.8938646475244041*x[4], -1.6095089024607847]) >= -1*bigM*z[0]
Lp_prob += p.lpSum([0.4977846546859316*x[0], 0.9339586404790269*x[1], 0.7045450501147585*x[2], 0.14106458223169882*x[3], 0.5387275535558848*x[4], -1.0363346899783967]) >= -1*bigM*z[1]
Lp_prob += p.lpSum([0.6083112155609592*x[0], 0.3697079659317709*x[1], 0.6756455858362159*x[2], 0.4080595008081572*x[3], 0.7423756310965319*x[4], -1.2079778143487108]) >= -1*bigM*z[2]
Lp_prob += p.lpSum([0.4771233396351928*x[0], 0.1506640257299129*x[1], 0.41190251499086405*x[2], 0.526835809139328*x[3], 0.3316014018049621*x[4], -0.8262355819468763]) >= -1*bigM*z[3]
Lp_prob += p.lpSum([0.6978784472024352*x[0], 0.6151888953549444*x[1], 0.18759475955659555*x[2], 0.6056924979608873*x[3], 0.5821126652604575*x[4], -0.8921437219592748]) >= -1*bigM*z[4]
Lp_prob += p.lpSum([0.592340660620111*x[0], 0.6880736586356949*x[1], 0.3869345738968548*x[2], 0.8051775509603918*x[3], 0.048824468205861615*x[4], -0.8802165845567489]) >= -1*bigM*z[5]
#------------------
Lp_prob += p.lpSum([0.4358122152170364*x[0], 0.7852764020735313*x[1], 0.7913074666352077*x[2], 0.8473006173083598*x[3], 0.8938646475244041*x[4], -1.6095089024607847]) <= bigM*z[0]
Lp_prob += p.lpSum([0.4977846546859316*x[0], 0.9339586404790269*x[1], 0.7045450501147585*x[2], 0.14106458223169882*x[3], 0.5387275535558848*x[4], -1.0363346899783967]) <= bigM*z[1]
Lp_prob += p.lpSum([0.6083112155609592*x[0], 0.3697079659317709*x[1], 0.6756455858362159*x[2], 0.4080595008081572*x[3], 0.7423756310965319*x[4], -1.2079778143487108]) <= bigM*z[2]
Lp_prob += p.lpSum([0.4771233396351928*x[0], 0.1506640257299129*x[1], 0.41190251499086405*x[2], 0.526835809139328*x[3], 0.3316014018049621*x[4], -0.8262355819468763]) <= bigM*z[3]
Lp_prob += p.lpSum([0.6978784472024352*x[0], 0.6151888953549444*x[1], 0.18759475955659555*x[2], 0.6056924979608873*x[3], 0.5821126652604575*x[4], -0.8921437219592748]) <= bigM*z[4]
Lp_prob += p.lpSum([0.592340660620111*x[0], 0.6880736586356949*x[1], 0.3869345738968548*x[2], 0.8051775509603918*x[3], 0.048824468205861615*x[4], -0.8802165845567489]) <= bigM*z[5]
# 3 wrong equations
Lp_prob += p.lpSum([0.9136542900179977*x[0], 0.1200576961563633*x[1], 0.21702526250869747*x[2], 0.6676284351675823*x[3], 0.9677793955604564*x[4], 0.8976526359716255]) >= -1*bigM*z[6]
Lp_prob += p.lpSum([0.19829758518929674*x[0], 0.7339857428076758*x[1], 0.4990517710694433*x[2], 0.08492143066990998*x[3], 0.6851296124709901*x[4], 0.9658774808551478]) >= -1*bigM*z[7]
Lp_prob += p.lpSum([0.8602452659349783*x[0], 0.6821233353552597*x[1], 0.9741984412949494*x[2], 0.34397353036739164*x[3], 0.357109126278345*x[4], 0.2700556947846583]) >= -1*bigM*z[8]
#------------------
Lp_prob += p.lpSum([0.9136542900179977*x[0], 0.1200576961563633*x[1], 0.21702526250869747*x[2], 0.6676284351675823*x[3], 0.9677793955604564*x[4], 0.8976526359716255]) <= bigM*z[6]
Lp_prob += p.lpSum([0.19829758518929674*x[0], 0.7339857428076758*x[1], 0.4990517710694433*x[2], 0.08492143066990998*x[3], 0.6851296124709901*x[4], 0.9658774808551478]) <= bigM*z[7]
Lp_prob += p.lpSum([0.8602452659349783*x[0], 0.6821233353552597*x[1], 0.9741984412949494*x[2], 0.34397353036739164*x[3], 0.357109126278345*x[4], 0.2700556947846583]) <= bigM*z[8]
#------------------
#------------------
solver = p.MOSEK()
status = Lp_prob.solve(solver) # Solver
print(p.value(Lp_prob.objective))

# Finding the diff
print(p.value(x[0])  + p.value(x[1])  + p.value(x[2])  + p.value(x[3])  + p.value(x[4])  + -1.99933886 )
